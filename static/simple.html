<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple FastAPI Example</title>
    <style>
        body { font-family: sans-serif; padding: 20px; max-width: 800px; margin: 0 auto; }
        .section { border: 1px solid #ccc; padding: 15px; margin-bottom: 20px; border-radius: 8px; }
        button { padding: 8px 16px; cursor: pointer; background-color: #007bff; color: white; border: none; border-radius: 4px; }
        button:hover { background-color: #0056b3; }
        input, select { padding: 8px; margin-right: 10px; }
        pre { background: #f4f4f4; padding: 10px; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>Simple FastAPI Consumer</h1>

    <!-- Section 1: GET Request -->
    <div class="section">
        <h2>1. GET Request (Hello World)</h2>
        <button onclick="getHello()">Say Hello</button>
        <div id="hello-result"></div>
    </div>

    <!-- Section 2: GET with Parameters -->
    <div class="section">
        <h2>2. GET Request with Parameters</h2>
        <input type="number" id="itemId" placeholder="Item ID (e.g. 123)">
        <input type="text" id="queryParam" placeholder="Query (optional)">
        <button onclick="getItem()">Get Item</button>
        <pre id="item-result"></pre>
    </div>

    <!-- Section 3: POST Request (Calculator) -->
    <div class="section">
        <h2>3. POST Request (Calculator)</h2>
        <input type="number" id="num1" placeholder="Number 1">
        <select id="operation">
            <option value="add">+</option>
            <option value="subtract">-</option>
            <option value="multiply">*</option>
            <option value="divide">/</option>
        </select>
        <input type="number" id="num2" placeholder="Number 2">
        <button onclick="calculate()">Calculate</button>
        <pre id="calc-result"></pre>
    </div>

    <script>
        // 1. Simple GET
        async function getHello() {
            try {
                const response = await fetch('/api/hello');
                const data = await response.json();
                document.getElementById('hello-result').innerText = JSON.stringify(data);
            } catch (error) {
                console.error('Error:', error);
            }
        }

        // 2. GET with Path and Query Parameters
        async function getItem() {
            const id = document.getElementById('itemId').value || 1;
            const q = document.getElementById('queryParam').value;
            let url = `/api/items/${id}`;
            if (q) {
                url += `?q=${q}`;
            }

            try {
                const response = await fetch(url);
                const data = await response.json();
                document.getElementById('item-result').innerText = JSON.stringify(data, null, 2);
            } catch (error) {
                console.error('Error:', error);
            }
        }

        // 3. POST with JSON body
        async function calculate() {
            const num1 = parseFloat(document.getElementById('num1').value);
            const num2 = parseFloat(document.getElementById('num2').value);
            const operation = document.getElementById('operation').value;

            if (isNaN(num1) || isNaN(num2)) {
                alert("Please enter valid numbers");
                return;
            }

            try {
                const response = await fetch('/api/calculate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        num1: num1,
                        num2: num2,
                        operation: operation
                    })
                });
                const data = await response.json();
                document.getElementById('calc-result').innerText = JSON.stringify(data, null, 2);
            } catch (error) {
                console.error('Error:', error);
            }
        }
    </script>
</body>
</html>
